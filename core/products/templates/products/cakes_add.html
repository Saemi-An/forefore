{% extends 'base.html' %}
{% load static %}
{% load customtags %}

{% block script %}
<script src="{% static 'js/products/cakes_add.js' %}" defer></script>
<style>
.visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}
</style>
{% endblock %}

{% block main %}
<form method="POST" action="{% if cake %}{% url 'cakes_add_and_edit' cake.pk %}{% else %}{% url 'cakes_add_and_edit' 0 %}{% endif %}" class="column_24" enctype="multipart/form-data" id="cakeForm">
  {% csrf_token %}
  <section class="paper">
    <p class="lg-bold">êµ¬ì›€ê³¼ì ìƒí’ˆ {% if cake %}ìˆ˜ì •{% else %}ë“±ë¡{% endif %}</p>
    
    <section class="form">
      <p class="lg-bold form__title">ìƒí’ˆ ì •ë³´</p>
      <div class="form__group">

        <div class="form__group__elem">
          <div class="gorm__group__elem__sub-title">
            <span class="md-bold">ìƒí’ˆëª…</span>
            <span class="md-bold txt-color-orange">*</span>
          </div>
          {{ form.name }}
          {% if form.name.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.name.errors }}</span>{% endif %}
        </div>

        <div class="form__group__elem">
          <span class="md-bold">ìƒí’ˆ ì„¤ëª…</span>
          {{ form.cmt }}
          {% if form.cmt.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.cmt.errors }}</span>{% endif %}
        </div>

        <div class="form__group__elem">
          <span class="md-bold">ìƒí’ˆ ì´ë¯¸ì§€</span>
          <span class="sm-reg txt-color-gray09">ì •ì‚¬ê°í˜• ë¹„ìœ¨ì˜ ìµœëŒ€ 2MBì˜ ì´ë¯¸ì§€ íŒŒì¼(jpg, jpeg, png)ì„ ì—…ë¡œë“œ í•´ì£¼ì„¸ìš”.</span>
          <div class="form__group__elem__upload" id="uploadDiv">
            <label for="fileUpload" class="md-reg">íŒŒì¼ ì„ íƒ</label>
            <span class="md-reg txt-color-gray09" id="customSpan">{% if cake %}{{ cake.img | drop_upload_to_cake }}{% else %}ì„ íƒëœ íŒŒì¼ ì—†ìŒ{% endif %}</span>
            {{ form.img }}
          </div>
          {% if form.img.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.img.errors }}</span>{% endif %}
          <div class="form__group__elem__preview{% if not cake %} display-none{% endif %}" id="imgPreviewDiv">
            <img src="{% if cake %}/admin_media/{{ cake.img }}{% endif %}" alt="">
          </div>
        </div>

      </div>
    </section>

    <section class="form">
      <p class="lg-bold form__title">í•„ìˆ˜ ì˜µì…˜</p>
      <div class="form__group">
        <div class="form__group__elem">
          <div class="gorm__group__elem__sub-title">
            <span class="md-bold">í˜¸ìˆ˜</span>
            <span class="md-bold txt-color-orange">*</span>
          </div>
          <div>
          {% for opt in main_options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
          {% if form.options.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.options.errors }}</span>{% endif %}
        </div>

      </div>
    </section>

    <section class="form">
      <p class="lg-bold form__title">ì„ íƒ ì˜µì…˜</p>
      <div class="form__group">
        {% for int_type, options in sub_options.items %}
        
        {% if int_type == 2 %}
        <div class="form__group__elem">
          <span class="md-bold">ê³¼ì¼ ì¶”ê°€</span>
          <div>
          {% for opt in options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
        </div>
        {% elif int_type == 3 %}
        <div class="form__group__elem">
          <span class="md-bold">ê³¼ì¼ ë¯¹ìŠ¤</span>
          <div>
          {% for opt in options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
        </div>
        {% elif int_type == 4 %}
        <div class="form__group__elem">
          <span class="md-bold">ìƒí¬ë¦¼ ë³€ê²½</span>
          <div>
          {% for opt in options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
        </div>
        {% elif int_type == 5 %}
        <div class="form__group__elem">
          <span class="md-bold">ì‹œíŠ¸ ë³€ê²½</span>
          <div>
          {% for opt in options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
        </div>
        {% elif int_type == 6 %}
        <div class="form__group__elem">
          <span class="md-bold">ì´ˆì½” ê¸€ë¼ì‚¬ì£¼</span>
          <div>
          {% for opt in options %}
            <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
              <div class="btn-check_off" data-selected-opt="{{ opt.pk }}"></div>
              <input type="checkbox" name="options" value="{{ opt.pk }}" class="visually-hidden">
              <span class="md-reg">{{ opt.name }}</span>
            </button>
          {% endfor %}
          </div>
        </div>
        {% endif %}

        {% endfor %}
      </div>
    </section>

    <section class="form">
      <p class="lg-bold form__title">í”½ì—…</p>
      <div class="form__group">

        <div class="form__group__elem">
          <span class="md-bold">í”½ì—… ë‚ ì§œ ë° ì‹œê°„</span>
          
          {% for label in form.schedules %}
          {% comment %} {% if label.data.value in form.schedules.value %}ì´ê²Œë­ì•¼{% endif %} {% endcomment %}
          <button type="button" class="modal__pickup__body__cnt__checkbox" onclick="customCheckBox(this)">
            <div class="btn-check_off"></div>
            {{ label.tag }}
            <span class="md-reg">{{ label.choice_label }}</span>
          </button>
          {% endfor %}

          {% if form.schedules.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.schedules.errors }}</span>{% endif %}
        </div>

      </div>
    </section>

    <section class="form">
      <p class="lg-bold form__title">ìƒí’ˆ ë…¸ì¶œ ì„¤ì •</p>
      <div class="form__group">

        <div class="form__group__elem">
          <span class="md-bold">ë””ìŠ¤í”Œë ˆì´</span>
          {{ form.display }}
          {% if form.display.errors %}<span class="sm-reg txt-color-orange mgl4">{{ form.display.errors }}</span>{% endif %}
        </div>

      </div>
    </section>

  </section>

  <section class="align both">
    <button type="button" class="md-reg btn-normal txt-color-green" onclick="goBack()">ë’¤ë¡œê°€ê¸°</button>
    <div class="view-btn">
      <button type="submit" class="emoji-btn green" onclick="submitCakeForm(event)">
        <div class="div_with_emoji">
          <span class="md-reg emoji_mgb04">ğŸ‘ğŸ½</span>
          <span type="submit" class="md-reg txt-color-white">ì €ì¥í•˜ê¸°</span>
          <input type="hidden" name="redirect_url" value="{{ referer }}">
        </div>
      </button>
    </div>
  </section>
</form>
{% endblock %}