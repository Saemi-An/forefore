{% extends 'base.html' %}
{% load static %}
{% load customtags %}

{% block script %}
<script src="{% static 'js/products/cookies.js' %}" defer></script>
{% endblock %}

{% block modal %}
<!-- ì¼ë°˜ ëª¨ë‹¬ -->
<div class="modal" id="normalModal">
  <div class="modal__cnt">
    {% if sales %}
    <p class="lg-bold">ğŸŒ™ ì˜ˆì•½ íŒë§¤ ë§ˆê° ğŸŒ™</p>
    <div class="modal__cnt__txt">
      <div>
        <p class="md-reg">ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ</p>
        <p class="md-reg"><span class="md-bold txt-color-orange">ì„ íƒëœ í”½ì—…ì‹œê°„ì´ ì´ˆê¸°í™” ë©ë‹ˆë‹¤.</span></p>
      </div>
      <div>
        <p class="md-reg">ì‚¬ìš©ì í˜ì´ì§€ì—ì„œ</p>
        <p class="md-reg"><span class="md-bold txt-color-orange">í”½ì—… ì‹œê°„ ì„ íƒë€ì´ ì´ˆê¸°í™” ë©ë‹ˆë‹¤.</span></p>
      </div>
      <div>
        <p class="md-reg">ì˜¤ëŠ˜ì˜ êµ¬ì›€ê³¼ì íŒë§¤ë¥¼</p>
        <p class="md-reg">ì¢…ë£Œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
      </div>
    </div>
    {% else %}
    <p class="lg-bold">âœ¨ ì˜ˆì•½ íŒë§¤ ì‹œì‘ âœ¨</p>
    <div class="modal__cnt__txt">
      <div>
        <p class="md-reg">íŒë§¤ ì¤‘ì—ëŠ”</p>
        <p class="md-reg"><span class="md-bold txt-color-orange">í”½ì—…ì‹œê°„ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥</span> í•©ë‹ˆë‹¤.</p>
      </div>
      <div>
        <p class="md-reg">ì˜¤ëŠ˜ì˜ êµ¬ì›€ê³¼ì íŒë§¤ë¥¼</p>
        <p class="md-reg">ì‹œì‘ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
      </div>
    </div>
    {% endif %}
    <div class="modal__cnt__btn">
      <button type="button" class="md-reg btn-normal txt-color-green" onclick="closeNormalModal()">ì·¨ì†Œ</button>
      <button class="md-reg btn-green txt-color-white" onclick="location.href='{% url 'change_cookies_sale' %}'">í™•ì¸</button>
    </div>
  </div>
</div>
<!-- í¼ ëª¨ë‹¬ -->
<div class="modal" id="formModal">
  <form action="" method="POST" class="modal__form" id="addCookieForm">
    {% csrf_token %}
    <p class="lg-bold">âš¡ï¸ íŒë§¤ ìƒí’ˆ ì¶”ê°€ âš¡ï¸</p>
    <div class="modal__form__cnt">
      <div class="modal__form__cnt__elem">
        <div class="modal__form__cnt__elem__sub-title">
          <p class="md-bold">íŒë§¤ ìƒí’ˆ</p>
          <span class="md-bold txt-color-orange">*</spans>
        </div>
        <select name="product" class="md-reg add_md-reg_class_to_options" id="selectProduct">
        {% for id, name in form.fields.product.choices %}
          <option value="{{ id }}" {% if id in form.registered %}disabled{% endif %}>{{ name }}</option>
        {% endfor %}
        </select>
        {% comment %} {{ form.product }} {% endcomment %}
        <span class="sm-reg txt-color-orange mgl4 display-none" id="selectProductMsg"></span>
      </div>
      <div class="modal__form__cnt__elem">
        <div class="modal__form__cnt__elem__sub-title">
          <p class="md-bold">ë…¸ì¶œ ìƒíƒœ</p>
          <span class="md-bold txt-color-orange">*</spans>
        </div>
        {{ form.status }}
        <span class="sm-reg txt-color-orange mgl4 display-none" id="selectStatusMsg"></span>
      </div>
      <div class="modal__form__cnt__elem-double">
        <div class="modal__form__cnt__elem">
          <div class="modal__form__cnt__elem__sub-title">
            <p class="md-bold">ì „ì²´ ì¬ê³  ìˆ˜ëŸ‰</p>
            <span class="md-bold txt-color-orange">*</spans>
          </div>
          {{ form.total }}
          <span class="sm-reg txt-color-orange mgl4 display-none" id="inputTotalMsg"></span>
        </div>
        <div class="modal__form__cnt__elem">
          <div class="modal__form__cnt__elem__sub-title">
            <p class="md-bold">ì•ˆì „ ì¬ê³  ìˆ˜ëŸ‰</p>
            <span class="md-bold txt-color-orange">*</spans>
            </div>
            {{ form.safe }}
            <span class="sm-reg txt-color-orange mgl4 display-none" id="inputSafeMsg"></span>
        </div>
      </div>
    </div>
    <div class="modal__form__btn">
      <button type="button" class="md-reg btn-normal txt-color-green" onclick="closeFormModal()">ì·¨ì†Œí•˜ê¸°</button>
      <button type="submit" class="md-reg btn-green txt-color-white" onclick="submitCookieAdd(event)">ì €ì¥í•˜ê¸°</button>
    </div>
  </form>
</div>
<!-- í”½ì—… í¼ ëª¨ë‹¬ -->
<div class="modal" id="pickupModal">
  <form action="{% url 'cookies_pickups_add' %}" method="POST" class="modal__pickup" id="pickupModalForm">
    {% csrf_token %}
    <p class="lg-bold">âš¡ï¸ í”½ì—… ì‹œê°„ ì¶”ê°€ âš¡ï¸</p>
    <div class="modal__pickup__elem">
      <div class="modal__pickup__elem__subtitle">
        <p class="md-bold">í”½ì—… ì‹œê°„</p>
        <span class="md-bold txt-color-orange">*</spans>
      </div>
      {% for time in times %}
      <button type="button" class="modal__pickup__elem__checkbox" onclick="selectPickupTimes(event, {{ time.id }})">
        <div class="btn-check_{% if time.selected %}on{% else %}off{% endif %}" data-selected="{{ time.id }}"></div>
        <span class="md-reg">{{ time.name }}</span>
      </button>
      {% endfor %}
      <span class="sm-reg txt-color-orange mgl4 display-none" id="checkSelectedMsg">í•„ìˆ˜ ì…ë ¥ê°’ ì…ë‹ˆë‹¤.</span>
    </div>
    <div class="modal__cnt__btn">
      <button type="button" class="md-reg btn-normal txt-color-green" onclick="closePickupModal()">ì·¨ì†Œí•˜ê¸°</button>
      <button type="submit" class="md-reg btn-green txt-color-white" onclick="submitPickupModal(event)">ì €ì¥í•˜ê¸°</button>
      <input type="hidden" name="selected_times" id="" value="">
    </div>
  </form>
</div>
{% endblock %}

{% block main %}
<!-- ê²€ìƒ‰ ì„¹ì…˜ -->
<section class="paper {% if sales %}on-sale{% endif %}">
  <div class="search">
    <p class="lg-bold">íŒë§¤ ì„¤ì •</p>
    <!-- ì¸í’‹ -->
    <div class="search__mid">
      <div class="search__mid__box">
        <p class="md-bold">íŒë§¤ ìƒíƒœ</p>
        <input type="text" class="md-bold search__mid__box no-input txt-color-{% if sales %}orange{% else %}navy{% endif %}" value="{% if sales %}ì˜ˆì•½ ê°€ëŠ¥{% else %}ì˜ˆì•½ ì¢…ë£Œ{% endif %}">
      </div>
      <div class="search__mid__box">
        <p class="md-bold">í”½ì—… ì‹œê°„</p>
      {% if selected_times %}
      {% for selected_time in selected_times %}
        <input type="text" class="md-reg search__mid__box no-input" value="{{ selected_time.name }}">
      {% endfor %}
      {% else %}
        <input type="text" class="md-reg search__mid__box no-input" value="í”½ì—… ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.">
      {% endif %}
      </div>
    </div>
    <!-- ë²„íŠ¼ -->
    <div class="search__btn align right">
      <button class="emoji-btn {% if sales %}on-sale{% endif %}" onclick="showPickupModal()">
        <div class="div_with_emoji">
          <span class="md-reg emoji_mgb02">â±ï¸</span>
          <span class="md-reg">í”½ì—… ì‹œê°„ ì¶”ê°€</span>
        </div>
      </button>
      <button class="emoji-btn green" onclick="showNormalModal()">
        <div class="div_with_emoji">
          <span class="md-reg emoji_mgb02">ğŸ›ï¸</span>
          <span class="md-reg txt-color-white">íŒë§¤ ìƒíƒœ ë³€ê²½</span>
        </div>
      </button>
    </div>
  </div>
</section>

<!-- í…Œì´ë¸” ì„¹ì…˜ -->
<section class="paper {% if sales %}on-sale{% endif %}">
  <div class="table">
    <!-- ìƒë‹¨ -->
    <div class="align both table__top">
      <span class="lg-bold">íŒë§¤ ìƒí’ˆ ëª©ë¡</span>
      <button class="emoji-btn green" onclick="showFormModal()">
        <div class="div_with_emoji">
          <span class="lg-reg emoji_mgb02">âœ¨</span>
          <span class="md-reg txt-color-white">íŒë§¤ ìƒí’ˆ ì¶”ê°€</span>
        </div>
      </button>
    </div>
    <!-- êµ¬ì›€ê³¼ì í•„í„° -->
    <ul class="table__tab">
      <li><button class="md-reg table__tab__filter {% if sales %}on-sale{% endif %} {% if filter == 100 %}active{% endif %}" onclick="location.href='{% url 'cookies' 'all' %}'">ğŸ€ ì „ì²´</button></li>
      <li><button class="md-reg table__tab__filter {% if sales %}on-sale{% endif %} {% if filter == 0%}active{% endif %}" onclick="location.href='{% url 'cookies' 'financier' %}'">ğŸ§ˆ íœ˜ë‚­ì‹œì—</button></li>
      <li><button class="md-reg table__tab__filter {% if sales %}on-sale{% endif %} {% if filter == 1%}active{% endif %}" onclick="location.href='{% url 'cookies' 'cakepiece' %}'">ğŸ° ì¡°ê°ì¼€ì´í¬</button></li>
      <li><button class="md-reg table__tab__filter {% if sales %}on-sale{% endif %} {% if filter == 2%}active{% endif %}" onclick="location.href='{% url 'cookies' 'scone' %}'">ğŸ¥® ìŠ¤ì½˜</button></li>
      <li><button class="md-reg table__tab__filter {% if sales %}on-sale{% endif %} {% if filter == 3%}active{% endif %}" onclick="location.href='{% url 'cookies' 'todays-menu' %}'">ğŸ¥¨ ì˜¤ëŠ˜ì˜ ë©”ë‰´</button></li>
    </ul>
    <!-- ì¤‘ë‹¨ -->
    <table class="table__table">
      <colgroup>
        <col style="width: 5%;">  <!-- ìˆœì„œ -->
        {% if filter != 100 %}
        <col style="width: 10%;">  <!-- ì¸ë±ìŠ¤ -->
        {% endif %}
        <col style="width: 7%;">  <!-- ì´ë¯¸ì§€ -->
        <col style="width: 10%;">  <!-- ìƒí’ˆìœ í˜• -->
        <col style="width: 20%;">  <!-- ìƒí’ˆëª… -->
        <col style="width: 10%;">  <!-- ê°€ê²© -->

        <col style="width: 14%;">  <!-- ë…¸ì¶œ ìƒíƒœ -->
        <col style="width: 8%;">  <!-- ì”ì—¬ ì¬ê³  -->
        <col style="width: 16%;">  <!-- ì•ˆì „ì¬ê³  / ì „ì²´ì¬ê³  -->

        <col style="width: 12%;">  <!-- ê¸°ëŠ¥ -->
      </colgroup>
      <thead {% if sales %}class="on-sale"{% endif %}>
        <tr>
          <th class="md-bold">ìˆœì„œ</th>
          {% if filter != 100 %}
          <th class="md-bold">ìˆœì„œ ë³€ê²½</th>
          {% endif %}
          <th class="md-bold">ì´ë¯¸ì§€</th>
          <th class="md-bold">ìƒí’ˆìœ í˜•</th>
          <th class="md-bold">ìƒí’ˆëª…</th>
          <th class="md-bold">ê°€ê²©</th>
          <th class="md-bold">ë…¸ì¶œ ìƒíƒœ</th>
          <th class="md-bold">ì”ì—¬ ì¬ê³ </th>
          <th class="md-bold">ì•ˆì „ì¬ê³  / ì „ì²´ì¬ê³ </th>
          <th class="md-bold">ê¸°ëŠ¥</th>
        </tr>
      </thead>
      <tbody {% if sales %}class="on-sale"{% endif %}>
        {% for cookie in cookies %}
        <tr>
          {% if filter == 100 %}
          <td class="md-reg">{{ forloop.counter }}</td>
          {% else %}
          <td class="md-reg">{{ cookie.index }}</td>
          <td class="md-reg">
            <div class="table__table__index">
              <button class="table__table__index__thumb" onclick="location.href='{% url 'change_cookies_index' cookie.product.category 'up' cookie.index %}'">ğŸ‘ğŸ½</button>
              <button class="table__table__index__thumb" onclick="location.href='{% url 'change_cookies_index' cookie.product.category 'down' cookie.index %}'">ğŸ‘ğŸ¼</button>
            </div>
          </td>
          {% endif %}
          <td>
            <img src="/admin_media/{{ cookie.product.img }}" alt="" class="table__table__img">
          </td>
          <td class="md-reg">{{ cookie.product.get_category_display }}</td>
          <td class="md-reg">{{ cookie.product.name }}</td>
          <td class="md-reg">{{ cookie.product.price | intcomma}}ì›</td>
          <td class="md-reg">
            {% if cookie.status == 0 %}
              âšªï¸ {{ cookie.get_status_display }}   <!-- íŒë§¤ ëŒ€ê¸°ì¤‘ -->
            {% elif cookie.status == 1 %}
              ğŸŸ¢ {{ cookie.get_status_display }}   <!-- íŒë§¤ì¤‘ -->
            {% elif cookie.status == 2 %}
              ğŸŸ¡ {{ cookie.get_status_display }}   <!-- ì¬ê³  ì†Œì§„ -->
            {% elif cookie.status == 3 %}
              âš«ï¸ {{ cookie.get_status_display }}   <!-- ì‹œì¦Œ ì¢…ë£Œ -->
            {% endif %}
          </td>
          <td class="md-reg">{{ cookie.current }}</td>
          <td class="md-reg">{{ cookie.safe }} / {{ cookie.total }}</td>
          <td class="">
            <div class="table__table__functions">
              <button class="lg-reg" onclick="location.href='{% url 'cookies_view' cookie.id %}'">ğŸ‘€</button>
              <button class="lg-reg" onclick="getEditCookieModal({{cookie.id}})">âœğŸ½</button>
              <button class="lg-reg" onclick="location.href='{% url 'cookies_delete' cookie.id %}'">ğŸ—‘ï¸</button>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <!-- í•˜ë‹¨ -->
    <div class="align center">
      <ul class="table__paging">
        <li class="align center"><button class="lg-bold">ğŸ‘ˆğŸ½</button></li>

        <li><button class="align center md-reg table__paging__btn">3</button></li>
        <li><button class="align center md-reg table__paging__btn">4</button></li>
        <li><button class="align center md-reg table__paging__btn">5</button></li>
        <li><button class="align center md-reg table__paging__btn active">6</button></li>
        <li><button class="align center md-reg table__paging__btn">7</button></li>
        <li><button class="align center md-reg table__paging__btn">8</button></li>
        <li><button class="align center md-reg table__paging__btn">9</button></li>

        <li class="align center"><button class="lg-bold">ğŸ‘‰ğŸ½</button></li>
      </ul>
    </div>
  </div>
</section>
{% endblock %}