{% extends 'base.html' %}
{% load static %}
{% load customtags %}

{% block script %}
<script src="{% static 'js/products/cookies_products.js' %}" defer></script>
{% endblock %}


{% block main %}
<!-- ê²€ìƒ‰ ì„¹ì…˜ -->
<section class="paper">
  <div class="search">
    <p class="lg-bold">ê²€ìƒ‰</p>
    <!-- ì¸í’‹ -->
    <div class="search__mid">
      <div class="search__mid__box">
        <p class="md-bold">ìƒí’ˆ ìœ í˜•</p>
        <select name="product_category" id="" class="md-reg search__mid__box">
          <option value="all" class="md-reg" {% if selected_category == 'all' %}selected{% endif %}>ì„ íƒí•´ ì£¼ì„¸ìš”.</option>
          <option value="financier" {% if selected_category == 'financier' %}selected{% endif %} class="md-reg">íœ˜ë‚­ì‹œì—</option>
          <option value="cakepiece" {% if selected_category == 'cakepiece' %}selected{% endif %} class="md-reg">ì¡°ê°ì¼€ì´í¬</option>
          <option value="scone" {% if selected_category == 'scone' %}selected{% endif %} class="md-reg">ìŠ¤ì½˜</option>
          <option value="todays-menu" {% if selected_category == 'todays-menu' %}selected{% endif %} class="md-reg">ì˜¤ëŠ˜ì˜ ë©”ë‰´</option>
        </select>
      </div>
    </div>
    <!-- ë²„íŠ¼ -->
    <div class="search__btn align right">
      <button type="button" class="md-reg btn-normal txt-color-green" onclick="location.href='{% url 'cookies_products' 'all' %}'">ì´ˆê¸°í™”</button>
      <button type="button" class="emoji-btn green" onclick="getFilteredProducts()">
        <div class="div_with_emoji">
          <span class="md-reg emoji_mgb02">ğŸ”</span>
          <span class="md-reg txt-color-white">ê²€ìƒ‰</span>
        </div>
      </button>
    </div>
  </div>
</section>

<!-- í…Œì´ë¸” ì„¹ì…˜ -->
<section class="paper">
  <div class="table">
    <!-- ìƒë‹¨ -->
    <div class="align both table__top">
      <span class="lg-bold">ìƒí’ˆ ëª©ë¡</span>
      <button class="emoji-btn green" onclick="location.href='{% url 'cookies_products_add' %}'">
        <div class="div_with_emoji">
          <span class="lg-reg emoji_mgb02">âœ¨</span>
          <span class="md-reg txt-color-white">ìƒí’ˆ ì¶”ê°€</span>
        </div>
      </button>
    </div>
    <!-- ì¤‘ë‹¨ -->
    <table class="table__table">
      <colgroup>
        <col style="width: 5%;">  <!-- ìˆœì„œ -->
        <col style="width: 7%;">  <!-- ì´ë¯¸ì§€ -->
        <col style="width: 10%;">  <!-- ìƒí’ˆìœ í˜• -->
        <col style="width: 20%;">  <!-- ìƒí’ˆëª… -->
        <col style="width: 10%;">  <!-- ê°€ê²© -->
        <col style="width: 30%;">  <!-- ìƒí’ˆ ì„¤ëª… -->
        <col style="width: 12%;">  <!-- ê¸°ëŠ¥ -->
      </colgroup>
      <thead>
        <tr>
          <th class="md-bold">ë²ˆí˜¸</th>
          <th class="md-bold">ì´ë¯¸ì§€</th>
          <th class="md-bold">ìƒí’ˆ ìœ í˜•</th>
          <th class="md-bold">ìƒí’ˆëª…</th>
          <th class="md-bold">ê°€ê²©</th>
          <th class="md-bold">ìƒí’ˆ ì„¤ëª…</th>
          <th class="md-bold">ê¸°ëŠ¥</th>
        </tr>
      </thead>
      <tbody>
        {% for product in products %}
        <tr>
          <td class="md-reg">{{ forloop.counter }}</td>
          <td>
            <img src="/admin_media/{{ product.img }}" alt="" class="table__table__img">
          </td>
          <td class="md-reg">{{ product.get_category_display }}</td>
          <td class="md-reg">{{ product.name }}</td>
          <td class="md-reg">{{ product.price | intcomma }}ì›</td>
          <td class="md-reg">{{ product.cmt }}</td>
          <td class="">
            <div class="table__table__functions">
              <button class="lg-reg" onclick="location.href='{% url 'cookies_products_view' product.id %}'">ğŸ‘€</button>
              <button class="lg-reg" onclick="location.href='{% url 'cookies_products_edit' product.id %}'">âœğŸ½</button>
              <button class="lg-reg" onclick="location.href='{% url 'cookies_products_delete' product.id %}'">ğŸ—‘ï¸</button>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <!-- í•˜ë‹¨ -->
    <div class="align center">
      <ul class="table__paging">
      {% if products.has_previous %}
        <li class="align center"><button class="lg-bold" onclick="location.href='?page=1'" title="ì²˜ìŒìœ¼ë¡œ">ğŸ‘ˆğŸ½</button></li>
      {% endif %}

      {% for page_num in products.paginator.page_range %}
        {% if page_num >= products.number|add:-4 and page_num <= products.number|add:4 %}
        {% if page_num == products.number %}
        <li><button class="align center md-reg table__paging__btn active" onclick="location.href='?page={{ page_num }}'">{{ page_num }}</button></li>
        {% else %}
        <li><button class="align center md-reg table__paging__btn" onclick="location.href='?page={{ page_num }}'">{{ page_num }}</button></li>
        {% endif %}
        {% endif %}
      {% endfor %}

      {% if products.has_next %}
        <li class="align center"><button class="lg-bold" onclick="location.href='?page={{ products.paginator.num_pages }}'" title="ë§ˆì§€ë§‰ìœ¼ë¡œ">ğŸ‘‰ğŸ½</button></li>
      {% endif %}
      </ul>
    </div>
  </div>
</section>
{% endblock %}